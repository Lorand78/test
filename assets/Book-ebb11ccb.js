import{r as o,a as s,o as c,c as _,w as r,b as F,t as Y,d as n,n as ce,m as q,e as U,f as te,g as le,u as pe,h as _e,i as me,j as H,k as W,l as J,p as Q,q as X,s as Z,v as I,x as fe,y as ye,z as oe}from"./index-1eb53deb.js";const ge={__name:"Snackbar",props:{p_activate:{type:Boolean,default:!0},p_title:String,p_rounded:{type:String,default:"pill"},p_color:{type:String,default:"green"},p_location:{type:String,default:"top"}},setup(u){const m=u;console.log(m.p_activate);const g=o(m.p_activate);return console.log("snackbar: "+g.value),(i,T)=>{const p=s("v-snackbar");return c(),_(p,{modelValue:g.value,"onUpdate:modelValue":T[0]||(T[0]=f=>g.value=f),timeout:2e3,color:u.p_color,rounded:u.p_rounded,location:u.p_location},{default:r(()=>[F(Y(u.p_title),1)]),_:1},8,["modelValue","color","rounded","location"])}}},be={key:1,class:"text-h6 pa-2"},ee={__name:"MyDialog",props:{p_disabled:{type:Boolean,default:!1},p_btnName:String,p_type:String,p_headerTitle:String,p_title:String,p_okBtnName:{type:String,default:"Mentés"},p_cancelBtnName:{type:String,default:"Mégsem"},p_rounded:{type:String,default:"lg"},p_color:{type:String,default:"primary"},p_icon:String,p_colpadding:{type:String,default:"padding: 0px 0px 0px 0px"},p_textFieldLabel:String,p_required:{type:Boolean,default:"false"}},setup(u,{expose:m}){const g=u,i=o(!1),T=o("OK"),p=o(null),f=o("");m({res:T,fieldTextValue:p,close(){$emit("close")}});function z(){console.log("fieldTextValue: ",p.value),p.value!=""&&p.value!=null&&(console.log("fieldTextValue: ",p.value),isActive=!1)}return(y,D)=>{const L=s("v-btn"),h=s("v-toolbar"),A=s("v-text-field"),K=s("v-card-text"),S=s("v-card-actions"),B=s("v-card"),x=s("v-dialog"),V=s("v-col");return c(),_(S,null,{default:r(()=>[n(V,{cols:"auto",style:ce(u.p_colpadding)},{default:r(()=>[n(x,{persistent:"",transition:"dialog-top-transition",width:"auto"},{activator:r(({props:d})=>[u.p_btnName?(c(),_(L,q({key:1,rounded:u.p_rounded,elevation:"16",color:u.p_color},d,{disabled:u.p_disabled}),{default:r(()=>[F(Y(u.p_btnName),1)]),_:2},1040,["rounded","color","disabled"])):(c(),_(L,q({key:0,icon:u.p_icon,rounded:u.p_rounded,elevation:"16",color:u.p_color},d,{disabled:u.p_disabled}),null,16,["icon","rounded","color","disabled"]))]),default:r(({isActive:d})=>[n(B,{rounded:"lg",elevation:"16",color:"#e3d19f"},{default:r(()=>[u.p_headerTitle?(c(),_(h,{key:0,rounded:"lg",elevation:"16",density:"compact",color:u.p_type,title:u.p_headerTitle},null,8,["color","title"])):U("",!0),n(K,null,{default:r(()=>[u.p_textFieldLabel?(c(),_(A,{key:0,autofocus:"",style:{"min-width":"250px"},modelValue:p.value,"onUpdate:modelValue":[D[0]||(D[0]=v=>p.value=v),D[1]||(D[1]=v=>p.value?f.value="":f.value="Kötelező mező")],clearable:"",label:u.p_textFieldLabel,variant:"solo-filled",required:u.p_required,rules:[v=>!!v],"error-messages":f.value,onKeydown:[D[2]||(D[2]=te(v=>z(),["enter"])),te(v=>d.value=!1,["esc"])]},null,8,["modelValue","label","required","rules","error-messages","onKeydown"])):U("",!0),u.p_title?(c(),le("div",be,Y(u.p_title),1)):U("",!0)]),_:2},1024),n(B,{variant:"tonal"},{default:r(()=>[n(S,{class:"justify-end",style:{"min-height":"auto"}},{default:r(()=>[n(L,q({disabled:(f.value!=""||p.value==""||p.value==null)&&u.p_textFieldLabel,variant:"tonal",density:"compact",color:u.p_color},g,{onClick:v=>{d.value=!1,T.value="OK",i.value=!0,y.$emit("close"),p.value=""}}),{default:r(()=>[F(Y(u.p_okBtnName),1)]),_:2},1040,["disabled","color","onClick"]),n(L,{variant:"tonal",density:"compact",onClick:v=>{d.value=!1,T.value="CANCEL",p.value=""}},{default:r(()=>[F(Y(u.p_cancelBtnName),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1})]),_:1},8,["style"])]),_:1})}}},ke={key:0},Be={key:1},Te={__name:"Book",setup(u){const m=pe(),g=m.currentRoute.value.params.type,i=g=="details",T=o(!1),p=o(!1),f=o("N"),z=o(""),y=o(!1),D=o(null),L=o(null),h=o(null),A=o(null),K=o("green");o(null);const S=o("2023"),B=o(2.5),x=o("");o(null);const V=o(""),d=o(null),v=o(null),E=o(null),N=o({OS_ID:null,OS_NAME:null}),w=o({PS_ID:null,PS_PUBLISHERNAME:null}),O=o(""),C=o(""),P=o(""),M=o("");o("");function $(a,e,t){const b=o(-1);for(let k=0;k<a.value.length&&b.value==-1;k++)a.value[k][e]==t&&(b.value=k);return b.value}const ne=async a=>{console.log("route: ",m.currentRoute.value.params.type);try{console.log("currroute: ",m.currentRoute.value.query.id);const e=await H.get("/api/data/"+a+"/NULL");console.log("response: ",e.data),z.value=e.data[0].BK_BOOKTITLE,f.value=e.data[0].BK_READED,d.value=W.value[$(W,"AT_ID",e.data[0].BK_AT)].AT_AUTHORNAME,console.log("actauthor: ",d.value),v.value=J.value[$(J,"CG_ID",e.data[0].BK_CG_ID)].CG_CATEGORY,E.value=Q.value[$(Q,"BT_ID",e.data[0].BK_BT)].BT_TYPENAME,e.data[0].BK_OS_ID!=null&&(N.value.OS_ID=e.data[0].BK_OS_ID,N.value.OS_NAME=X.value[$(X,"OS_ID",e.data[0].BK_OS_ID)].OS_NAME),e.data[0].BK_PS_ID!=null&&(w.value.PS_ID=e.data[0].BK_PS_ID,w.value.PS_PUBLISHERNAME=Z.value[$(Z,"PS_ID",e.data[0].BK_PS_ID)].PS_PUBLISHERNAME),S.value=e.data[0].BK_YEAR_OF_PUBLICATION,B.value=e.data[0].BK_RATE,x.value=e.data[0].BK_DESCRIPTION}catch(e){console.log(e.response)}};_e(async()=>{console.log("onMounted"),T.value=!0,g=="new"?(V.value="Biztos menti az új könyvet?",O.value="Kötelező mező!",C.value="Kötelező mező!",M.value="Kötelező mező!",P.value="Kötelező mező!"):g=="modify"&&(V.value="Biztos menti a könyv módosítását?"),g!="new"&&await ne("BK/"+m.currentRoute.value.query.id),T.value=!1}),me(()=>m.currentRoute.value.params.type,()=>{console.log(m.currentRoute.value.params.type),location.reload()});async function ue(){if(console.log("saveBook!!!"),!(O.value==""&&C.value==""&&P.value==""&&M.value==""))A.value=" Vannak kitöltetlen kötelező mezők! ",K.value="red",y.value=!0,setTimeout(()=>{y.value=!1},2e3);else{p.value=!0,console.log(h.value.res);const b=o("");let k=o(""),R=o(null);try{if(g=="new"){var a="INSERT INTO BOOK (BK_BOOKTITLE, BK_READED, BK_USER",e=" VALUES ('"+z.value+"', '"+f.value+"', '"+ye.value+"'";d.value.AT_ID&&(a=a+", BK_AT",e=e+", "+d.value.AT_ID),v.value.CG_ID&&(a=a+", BK_CG_ID",e=e+", "+v.value.CG_ID),E.value.BT_ID&&(a=a+", BK_BT",e=e+", "+E.value.BT_ID),a=a+", BK_OS_ID",N.value!=null?e=e+", "+N.value.OS_ID:e=e+", NULL",a=a+", BK_PS_ID",w.value!=null?e=e+", "+w.value.PS_ID:e=e+", NULL",S.value!=null&&(a=a+", BK_YEAR_OF_PUBLICATION",e=e+", "+S.value),B.value!=null&&(a=a+", BK_RATE",e=e+", "+B.value),x.value!=null&&(a=a+", BK_DESCRIPTION",e=e+", '"+x.value+"'"),R=await H.post("/book",{query:a+")"+e+")"}),k.value="felvitele"}else{var t="UPDATE BOOK SET BK_BOOKTITLE = '"+z.value+"', BK_READED = '"+f.value+"'";d.value.AT_ID&&(t=t+", BK_AT = "+d.value.AT_ID),v.value.CG_ID&&(t=t+", BK_CG_ID = "+v.value.CG_ID),E.value.BT_ID&&(t=t+", BK_BT = "+v.value.BT_ID),N.value!=null?t=t+", BK_OS_ID = "+N.value.OS_ID:t=t+", BK_OS_ID = NULL",w.value!=null?t=t+", BK_PS_ID = "+w.value.PS_ID:t=t+", BK_PS_ID = NULL",S.value!=null&&(t=t+", BK_YEAR_OF_PUBLICATION = "+S.value),B.value!=null&&(t=t+", BK_RATE = "+B.value),x.value!=null&&(t=t+", BK_DESCRIPTION = '"+x.value+"'"),t=t+" WHERE BK_ID = "+m.currentRoute.value.query.id,R=await H.post("/book",{query:t}),k.value="módosítása"}console.log("res: ",R),R&&R.status=="200"?b.value="A könyv "+k.value+" sikeresen megtörtént!":b.value="Hiba történt a könyv "+k.value+" közben!"}catch(j){console.log(j.response),b.value="Hiba történt a könyv "+k.value+" közben!",A.value=b.value,K.value="red",y.value=!0,setTimeout(()=>{y.value=!1},2e3)}A.value=b.value,K.value="green",y.value=!0,setTimeout(()=>{y.value=!1},2e3),await m.replace("/")}}async function re(){console.log("refMyDialogNewAuthor.value.fieldTextValue: ",D.value.fieldTextValue);const a=o("");K.value="red";try{const e=await H.post("/add/AT",{name:D.value.fieldTextValue});console.log(e),e&&e.status=="200"?(a.value="A szerző felvitele sikeresen megtörtént!",K.value="green",await oe("AT")):a.value="Hiba történt a szerző felvitele közben!"}catch(e){console.log(e.response),a.value="Hiba történt a szerző felvitele közben!"}A.value=a.value,y.value=!0,setTimeout(()=>{y.value=!1},2e3)}async function ie(){const a=o("");K.value="red";try{const e=await H.post("/add/PS",{name:L.value.fieldTextValue});console.log(e),e&&e.status=="200"?(a.value="A kiadó felvitele sikeresen megtörtént!",K.value="green",await oe("PS")):a.value="Hiba történt a kiadó felvitele közben!"}catch(e){console.log(e.response),a.value="Hiba történt a kiadó felvitele közben!"}A.value=a.value,y.value=!0,setTimeout(()=>{y.value=!1},2e3)}return(a,e)=>{const t=s("v-col"),b=s("v-text-field"),k=s("v-switch"),R=s("v-icon"),j=s("v-card"),G=s("v-autocomplete"),de=s("v-rating"),ve=s("v-textarea"),ae=s("v-row"),se=s("v-container");return c(),_(se,{fluid:""},{default:r(()=>[y.value==!0?(c(),_(ge,{key:0,p_title:A.value,p_color:K.value},null,8,["p_title","p_color"])):U("",!0),n(ae,null,{default:r(()=>[n(t,{cols:"2"}),n(t,{cols:"8"},{default:r(()=>[n(j,{rounded:"lg",elevation:"16",color:"black",variant:"tonal",style:{padding:"10px","background-color":"antiquewhite"},loading:T.value},{default:r(()=>[I(W)&&I(J)&&I(Q)&&I(X)&&I(Z)?(c(),_(ae,{key:0},{default:r(()=>[n(t,{cols:"8"},{default:r(()=>[n(b,{modelValue:z.value,"onUpdate:modelValue":[e[0]||(e[0]=l=>z.value=l),e[3]||(e[3]=l=>O.value="")],clearable:!i,label:"Cím",variant:"solo-filled",readonly:i,class:fe({disabledback:i}),density:"compact",required:!0,rules:[l=>!!l],"error-messages":O.value,onKeyup:e[1]||(e[1]=l=>z.value==""?O.value="Kötelező mező!":O.value=""),"onClick:clear":e[2]||(e[2]=l=>O.value="Kötelező mező!")},null,8,["modelValue","clearable","readonly","class","rules","error-messages"])]),_:1}),n(t,{cols:"1",style:{padding:"10px 0px 0px 0px"}},{default:r(()=>[n(k,{class:"text-center grey d-flex flex-column align-center justify-center",modelValue:f.value,"onUpdate:modelValue":e[4]||(e[4]=l=>f.value=l),color:"blue","hide-details":"","true-value":"Y","false-value":"N",readonly:i},null,8,["modelValue","readonly"])]),_:1}),n(t,{cols:"1",style:{padding:"15px 0px 0px 0px"}},{default:r(()=>[n(j,{class:"text-center grey d-flex flex-column align-center justify-center",height:"50%",width:"50%"},{default:r(()=>[f.value=="Y"?(c(),le("div",ke,[n(R,{icon:"fa fa-book"})])):(c(),le("div",Be,[n(R,{icon:"mdi-book-open-page-variant-outline"})]))]),_:1})]),_:1}),n(t,{cols:"4"},{default:r(()=>[(c(),_(G,{style:{"min-width":"250px"},clearable:!i,modelValue:d.value,"onUpdate:modelValue":[e[5]||(e[5]=l=>d.value=l),e[8]||(e[8]=l=>d.value!=""||d.value!=null||d.value!=null?C.value="":null)],label:"Szerző",items:I(W),key:a.AT_ID,"item-title":"AT_AUTHORNAME","item-value":"AT_ID",variant:"solo-filled","return-object":"",readonly:i,density:"compact","no-data-text":"Nincs a keresésnek megfelelő adat",required:!0,rules:[l=>!!l],"error-messages":C.value,onKeyup:e[6]||(e[6]=l=>d.value==""||d.value==null||d.value==null?C.value="Kötelező mező!":C.value=""),"onClick:clear":e[7]||(e[7]=l=>C.value="Kötelező mező!")},null,8,["clearable","modelValue","items","readonly","rules","error-messages"]))]),_:1}),n(ee,{ref_key:"refMyDialogNewAuthor",ref:D,p_type:"brown",p_icon:"fa fa-pencil",p_headerTitle:"Új szerző felvitele",p_rounded:"xl",p_colpadding:"padding: 0px 0px 20px 0px",p_textFieldLabel:"Új szerző",onClose:e[9]||(e[9]=l=>re()),p_disabled:i,p_required:" true ",p_color:"black"},null,8,["p_disabled"]),n(t,{cols:"2"},{default:r(()=>[(c(),_(G,{style:{"min-width":"150px"},modelValue:v.value,"onUpdate:modelValue":[e[10]||(e[10]=l=>v.value=l),e[13]||(e[13]=l=>P.value="")],clearable:!i,label:"Műfaj",items:I(J),key:a.AT_ID,"item-title":"CG_CATEGORY","item-value":"CG_ID",variant:"solo-filled","return-object":"",readonly:i,density:"compact",required:!0,rules:[l=>!!l],"error-messages":P.value,onKeyup:e[11]||(e[11]=l=>v.value==""||v.value==null?P.value="Kötelező mező!":P.value=""),"onClick:clear":e[12]||(e[12]=l=>P.value="Kötelező mező!")},null,8,["modelValue","clearable","items","readonly","rules","error-messages"]))]),_:1}),n(t,{cols:"3"},{default:r(()=>[(c(),_(G,{style:{"min-width":"150px"},modelValue:E.value,"onUpdate:modelValue":[e[14]||(e[14]=l=>E.value=l),e[17]||(e[17]=l=>M.value="")],clearable:!i,label:"Kategória",items:I(Q),key:a.BT_ID,"item-title":"BT_TYPENAME","item-value":"BT_ID",variant:"solo-filled","return-object":"",readonly:i,density:"compact",required:!0,rules:[l=>!!l],"error-messages":M.value,onKeyup:e[15]||(e[15]=l=>E.value==""||E.value==null?M.value="Kötelező mező!":M.value=""),"onClick:clear":e[16]||(e[16]=l=>M.value="Kötelező mező!")},null,8,["modelValue","clearable","items","readonly","rules","error-messages"]))]),_:1}),n(t,{cols:"3"},{default:r(()=>[(c(),_(G,{style:{"min-width":"150px"},modelValue:N.value,"onUpdate:modelValue":e[18]||(e[18]=l=>N.value=l),clearable:!i,label:"Státusz",items:I(X),key:a.OS_ID,"item-title":"OS_NAME","item-value":"OS_ID",variant:"solo-filled","return-object":"",readonly:i,density:"compact"},null,8,["modelValue","clearable","items","readonly"]))]),_:1}),n(t,{cols:"3"},{default:r(()=>[(c(),_(G,{style:{"min-width":"150px"},modelValue:w.value,"onUpdate:modelValue":e[19]||(e[19]=l=>w.value=l),clearable:!i,label:"Kiadó",items:I(Z),key:a.PS_ID,"item-title":"PS_PUBLISHERNAME","item-value":"PS_ID",variant:"solo-filled","return-object":"",readonly:i,density:"compact"},null,8,["modelValue","clearable","items","readonly"]))]),_:1}),n(ee,{ref_key:"refMyDialogNewPublisher",ref:L,p_type:"brown",p_icon:"fa fa-pencil",p_headerTitle:"Új kiadó felvitele",p_rounded:"xl",p_colpadding:"padding: 0px 0px 20px 0px",p_textFieldLabel:"Új kiadó",onClose:e[20]||(e[20]=l=>ie()),p_disabled:i,p_required:" true ",p_color:"antiquewhite"},null,8,["p_disabled"]),n(t,{cols:"2"},{default:r(()=>[n(b,{modelValue:S.value,"onUpdate:modelValue":e[21]||(e[21]=l=>S.value=l),type:"number",label:"Kiadás dátuma",variant:"solo-filled",readonly:i,density:"compact"},null,8,["modelValue","readonly"])]),_:1}),n(t,{cols:"2"},{default:r(()=>[n(de,{class:"mt-3",modelValue:B.value,"onUpdate:modelValue":e[22]||(e[22]=l=>B.value=l),"half-increments":"",hover:"",length:5,size:a.x-a.large,"model-value":B.value,color:"black","active-color":"red","empty-icon":"mdi-heart-outline","half-icon":"mdi-heart-half-full","full-icon":"mdi-heart",readonly:i},null,8,["modelValue","size","model-value","readonly"])]),_:1}),n(t,{cols:"12"},{default:r(()=>[n(ve,{modelValue:x.value,"onUpdate:modelValue":e[23]||(e[23]=l=>x.value=l),rounded:"lg",elevation:"16",label:"Leírás",variant:"solo-filled",readonly:i,density:"compact"},null,8,["modelValue","readonly"])]),_:1})]),_:1})):U("",!0),I(g)!="details"?(c(),_(j,{key:1,rounded:"lg",elevation:"16",variant:"tonal"},{default:r(()=>[n(ee,{ref_key:"refMyDialog",ref:h,p_type:"brown",p_btnName:"Mentés",p_disabled:!(O.value==""&&C.value==""&&P.value==""&&M.value==""),modtype:"error",p_headerTitle:"Mentés jóváhagyása",p_title:V.value,p_color:"black",onClose:e[24]||(e[24]=l=>ue())},null,8,["p_disabled","p_title"])]),_:1})):U("",!0)]),_:1},8,["loading"])]),_:1}),n(t,{cols:"2"})]),_:1})]),_:1})}}};export{Te as default};
